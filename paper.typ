#set document(title: [基于Fourier变换的吉他弦驻波频谱分析])

#set page(
  paper: "us-letter",
  header: align(
    right + horizon,
    "东南大学物理实验课程论文",
  ),
  numbering: "1",
  columns: 2,
)

#set math.equation(numbering: "(1)")

#show title: set text(size: 17pt)
#show title: set align(center)
#show title: set block(below: 1.2em)

#set heading(numbering: "1.a")

#place(
  top + center,
  float: true,
  scope: "parent",
  clearance: 2em,
)[

  #title()
  #align(center)[
    张佩宇 \
    东南大学 人工智能学院 \
    #link("zpeiyu11@gmail.com")
  ]
  #par(justify: false)[
    摘要 \
    吉他弦的振动是经典波动现象的直观体现，其频谱特性不仅决定了乐器的音色，更蕴含着波动方程在边界条件下的本征模态信息。实际乐器中弦的振动是否遵循理想驻波模型？谐波成分的分布规律如何？这些问题的答案对理解乐器物理和指导乐器设计具有重要意义。于是，本次实验通过电吉他 G 弦的频谱测量来验证理想弦振动理论。实验采用声卡采集弦振动信号，使用快速 Fourier 变换（FFT）分析不同品位下的基频与谐波成分，并将测量结果与理论预测进行对比。实验发现，测量得到的频率与基于驻波理论计算的理论值高度吻合，验证了理想弦振动模型在实际应用中的有效性，同时也为数字信号处理技术在物理实验中的应用提供了实践案例。
  ]
]

= 引言
吉他弦的振动是经典波动现象的直观体现：在两端固支的条件下，弦上会形成一组驻波，其振动频率按照整数倍的谐次分布。研究弦振动的频谱不仅有助于理解波动方程与边界条件下的本征模态，而且对乐器音色、共振与阻尼机制的分析具有重要意义。

理论上，均匀张力为$T$、线密度为$mu$、有效弦长为$L$的理想弦，其固有频率满足$f_n=n/(2L)sqrt(T/mu)(n=1,2,3,...)$。实际乐器中，弦的刚性、弦体耦合、弦端条件非理想性与阻尼等都会引入谱线偏移和展宽。

Fourier变换（及其数值实现------Fast Fourier Transform，FFT）是将时域信号映射到频域、识别基频与谐次成分的标准工具；在有限采样与有限时窗条件下，采样率、窗函数和零填充等参数会影响频谱分辨率与谱泄露特性。

本实验旨在：记录单根吉他弦的时域振动信号，使用 FFT 提取频谱特征，识别基频与若干高次谐波，并将测得频率与理论值进行比较与不确定度分析。文章结构如下：首先简要回顾相关理论，随后介绍实验装置与数据采集方法，再给出数据处理与频谱分析过程，最后呈现实验结果并讨论偏差来源与改进建议。

= 理论基础
== 理想弦的固有频率
在理想化条件下（均匀细弦、两端固支、无阻尼且小振幅），弦的振动满足一维波动方程，其定常解为驻波，固有频率为
$ f_n=n/(2L)sqrt(T/mu) quad, n=1,2,3,... $
其中$L$为有效弦长，$T$为张力，$mu$为线密度，$n$为模态阶数（$n=1$为基频）。该公式基于两端位移为零的边界条件。完整推导在文献 @liang2006mechanics 中有详细给出，故此处略去推导。

== Fourier变换及其数值实现
Fourier变换在连续空间的定义为 @wang2005mathematical：
$ X(f)=integral_(-infinity)^(+infinity)x(t)e^(-2pi i f t)"dt" $
在数字信号处理时，模拟信号会被采样和量化到离散空间。在离散空间中处理周期性信号使用离散Fourier变换（DFT），其定义为
$ X_k=sum_(n=0)^(N-1)x_n e^(-2pi i (k n)/N) \ (k=0,1,...,N-1) $
工程上，DFT的朴素实现版本对于计算机来说处理开销很大。所以一般使用DFT的快速算法实现版本FFT @cooley1965algorithm，计算复杂度从$O(N^2)$降到$O(N log N)$。

== 数模转换基础
传感器获取的模拟信号经过采样和量化，从连续空间映射到离散空间，变为数字信号。计算机处理的音频数据就是数字信号。

采样与频率刻度是数字信号的重要属性。采样率记为$f_s$，则DFT第$k$个谱线对应的频率为$f_k=(k f_s)/N$，频率分辨率（即谱线的间隔）为
$ Delta f = f_s/N = 1/T_"rec" $
其中$T_"rec"$为记录时长。Nyquist频率为$f_(N y q)=f_s/2$，采样定理 @shannon1949communication 要求$f_s>2f_max$以避免混淆。


= 实验装置与方法
== 实验概览
实验分为三步。第一步为获取按照测量点，在测量条件下精确拨动目标吉他弦。第二步为数模转换，将声音振动模拟信号转化为计算机可处理的数字信号。第三步为数据处理与分析，事先编写程序，并由计算机完成这一步。

== 设备清单
- 计算机
- 声卡
- 一根6.5mm音频线
- 一根3.5mm音频线
- 电吉他与拨片

考虑到便利性，实验中采样的乐器使用电吉他。原声吉他需额外配备录音设备，以及更好的录音环境。电吉他拥有拾音器，拾音器输出的模拟信号经过声卡可以直接转换为数字信号，输入计算机处理。电吉他获取的信号除数模转换外不进行任何处理，包括箱头与箱体模拟。

计算机将离线处理获取的数据。即计算机不是实时处理接收到的信号，而是先存储数字信号文件，然后运行程序进行统一处理。程序由Python编写，CPython解释器运行，数学上使用NumPy的FFT实现。相关代码已在GitHub上开源 @glowled2026fft，并遵循MIT协议。

== 具体操作
1. 电吉他调整至标准音EADGBE。
2. 连接音频传输线路。使用6.5mm音频线连接电吉他与声卡，再使用3.5mm音频线连接声卡与计算机。
3. 电脑打开Reaper应用软件，创建新的音轨，并设置音轨输入为对应的声卡。测试音轨能否正常接收声音。
4. 选择3弦（G弦）作为实验对象。依次奏响空弦音，3品，5品，7品，9品，12品音。每次拨弦的位置严格固定在有效弦长的中点处。
5. 剪辑音频，并导出为多个.wav格式音频文件。文件命名统一为对应品的数字（空弦为0品）。
6. 运行编写好的Python程序，输出图表。

= 数据处理与分析方法
本节给出从原始音频到频谱结果的完整处理流程、关键参数与不确定度估计方法。总体流程为：读取并预处理时域信号 → 选择稳定段并加窗 → 计算 FFT（可选零填充）→ 幅度标定与谱线插值 → 峰值识别与谐波匹配 → 不确定度评估与可视化。

== 数据预处理
数据在导出音频前的剪辑过程中，已经截取了稳定段，去除了拨弦瞬态的部分。在导出音频时，采样率固定为44100 Hz，导出的文件格式为wav，避免音频经过压缩。

在分析程序运行阶段，会对信号进行去均值，进行RMS归一化，便于幅值比较。

== 窗函数与频率刻度
为抑制谱泄露，使用Hann窗对选定段进行加窗 @chen2001digital。窗函数记为$omega[n]$，加窗后的信号为
$ x_omega [n]=x[n]omega[n] $
使用FFT得到复谱$X_k$，DFT频率对应关系为
$ f_k = (k f_s)/N quad ,k=0,...,N-1 $
频率分辨率为
$ Delta f = f_s / N = 1 / T_"rec" $

== FFT、单边谱与幅值标定
使用real FFT（如`numpy.fft.rfft`）仅保留非负频率部分。得到复值频谱后取幅度谱$|X_k|$。

了得到物理意义的单侧幅值谱，应将除直流与 Nyquist 外的谱线乘以 2。考虑窗函数能量损失，幅值需除以窗的平均增益$G_omega = 1/N sum_(n=0)^(N-1)omega[n]$。因此单侧标定式可写为
$ A_k = (2|X_k|) / (N G_omega) $

若使用 RMS 或能量标定，可等价调整归一化因子。

== 零填充与谱线插值
在时域向后追加零可提升谱线的插值密度但不增加真实分辨率。常零填充到$N_m = "pow2"(N)*K ,quad (K=1,2,4)$。

用三点抛物线（parabolic）法对最大谱线的相邻三点进行插值，提高频率估计精度。设相邻幅值为$m_(-1)$，$m_0$，$m_(+1)$，峰值修正量
$ delta = (m_(-1) - m(+1))/(2(m_(-1) - 2m_0 + m_(+1))) $
则插值得到的频率为
$ f_"peak" = ((k+delta)f_s) / N_m $

== 可视化与结果呈现
绘制原始信号与加窗段，标注选用的$T_"rec"$。绘制线性频率轴与对数（dB）幅值，两者均展示。对每个谐波做竖线标注并显示测量频率与理论频率的差值。

= 分析结论
== 程序输出图表
图表详情将在附录中全部贴出，这里举出7品作为样例。

#figure(
  image("outputs/7.png", height: 40%),
  caption: [
    G弦7品程序分析输出图表
  ]
)

== 实验结果分析
从图表中可以看出，程序成功提取了G弦7品的时域信号，并转换为频域信号。通过FFT分析，我们得到了线性谱和对数幅度谱，清晰地展示了弦振动的频率成分。

上图展示了G弦7品的时域信号，其中蓝色区域表示预处理后的选定段，灰色区域表示原始信号。可以观察到信号在开始时有一个明显的瞬态响应，随后进入稳定的振动状态。这种瞬态响应是由于拨弦引起的，而稳定的振动状态则对应于弦的驻波模式。

中图展示了线性谱，其中红色标记表示识别出的峰值频率。可以看到，主要的峰值频率集中在293.7 Hz附近，这与理论预测的基频相符。此外，还可以观察到一些高次谐波，这些谐波是基频的整数倍，符合驻波的振动特性。

下图展示了对数幅度谱，进一步确认了主要频率成分的位置和幅度。对数幅度谱使得较小的幅度变化更加明显，有助于识别弱谐波成分。

通过峰值识别，我们得到了以下主要频率成分：
- 基频：293.7 Hz
- 第一谐频：587 Hz
- 第二谐频：881 Hz
== 结论
实验结果表明，通过FFT分析可以有效地识别吉他弦的振动频率成分。与理论预测相比，实验结果具有较高的一致性。

实验结果与通过驻波理论计算的值几乎没有差别，说明了驻波理论在吉他弦上是正确的，甚至是决定了吉他所拥有的独特音色。也基本可以说明，业界基本是按照驻波理论制造吉他，使得其基本符合驻波的理论计算。

使用FFT进行频谱分析，可以指导乐器设计。通过调整琴体材料，结构等方式，可以更改不同频率的能量占比，来根据喜好塑造不同的音色。

= 参考文献
#bibliography("references.bib")

= 附录
#figure(
  image("outputs/0.png", height: 60%),
  caption: [
    G弦空弦程序分析输出图表
  ]
)
#figure(
  image("outputs/3.png", height: 60%),
  caption: [
    G弦3品程序分析输出图表
  ]
)
#figure(
  image("outputs/5.png", height: 60%),
  caption: [
    G弦5品程序分析输出图表
  ]
)
#figure(
  image("outputs/7.png", height: 60%),
  caption: [
    G弦7品程序分析输出图表
  ]
)
#figure(
  image("outputs/9.png", height: 60%),
  caption: [
    G弦9品程序分析输出图表
  ]
)
#figure(
  image("outputs/12.png", height: 60%),
  caption: [
    G弦12品程序分析输出图表
  ]
)